version: '3'
services:
    gohelloworld:
        build: .
        image: gohelloworld:latest
        ports: 
            - "8080:8080"
    gobase:
        image: golang:latest
        working_dir: "/app/src"
        volumes: 
            - "./:/app"
    awscli:
        image: amazon/aws-cli
        working_dir: "/app"
        env_file: 
            - ./aws.env

    wdio-testlocal:
        # image: registry.gitlab.int.bell.ca/entpay/ace/react-test-docker/reacttest.chrome
        image: localtest-hello-world:$BROWSER
        working_dir: "/app"
        volumes:
            - "./test/wdio.conf.js:/app/wdio.conf.js"
            - "./test/wdio.conf.chrome.js:/app/wdio.conf.chrome.js"
            - "./test/wdio.conf.firefox.js:/app/wdio.conf.firefox.js"
            - "./test/features:/app/features"
        environment:
            - BROWSER=$BROWSER
        depends_on:
            - gohelloworld